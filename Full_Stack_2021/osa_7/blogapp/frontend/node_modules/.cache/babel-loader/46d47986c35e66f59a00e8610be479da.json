{"ast":null,"code":"var _jsxFileName = \"/home/ytuukka/Full_Stack_2021/osa_7/blogapp/frontend/src/App.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef } from 'react';\nimport { createStore } from 'redux';\nimport Blog from './components/Blog';\nimport LoginForm from './components/LoginForm';\nimport NewBlogForm from './components/NewBlogForm';\nimport Notification from './components/Notification';\nimport Togglable from './components/Togglable';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport userService from './services/user';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\nconst initialState = {\n  message: null,\n  type: 'info'\n};\n\nconst notificationReducer = function () {\n  let state = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : initialState;\n  let action = arguments.length > 1 ? arguments[1] : undefined;\n\n  switch (action.type) {\n    case 'SET':\n      return state = action.data;\n\n    default:\n      return state;\n  }\n};\n\nconst store = createStore(notificationReducer);\n\nconst App = () => {\n  _s();\n\n  const [blogs, setBlogs] = useState([]);\n  const [user, setUser] = useState(null);\n  const [notification, setNotification] = useState(null);\n  const blogFormRef = useRef();\n\n  const byLikes = (b1, b2) => b2.likes > b1.likes ? 1 : -1;\n\n  useEffect(() => {\n    blogService.getAll().then(blogs => setBlogs(blogs.sort(byLikes)));\n  }, []);\n  useEffect(() => {\n    const userFromStorage = userService.getUser();\n\n    if (userFromStorage) {\n      setUser(userFromStorage);\n    }\n  }, []);\n\n  const login = async (username, password) => {\n    loginService.login({\n      username,\n      password\n    }).then(user => {\n      setUser(user);\n      userService.setUser(user);\n      notify(`${user.name} logged in!`);\n    }).catch(() => {\n      notify('wrong username/password', 'alert');\n    });\n  };\n\n  const logout = () => {\n    setUser(null);\n    userService.clearUser();\n    notify('good bye!');\n  };\n\n  const createBlog = async blog => {\n    blogService.create(blog).then(createdBlog => {\n      notify(`a new blog '${createdBlog.title}' by ${createdBlog.author} added`);\n      setBlogs(blogs.concat(createdBlog));\n      blogFormRef.current.toggleVisibility();\n    }).catch(error => {\n      notify('creating a blog failed: ' + error.response.data.error, 'alert');\n    });\n  };\n\n  const removeBlog = id => {\n    const toRemove = blogs.find(b => b.id === id);\n    const ok = window.confirm(`remove '${toRemove.title}' by ${toRemove.author}?`);\n\n    if (!ok) {\n      return;\n    }\n\n    blogService.remove(id).then(() => {\n      const updatedBlogs = blogs.filter(b => b.id !== id).sort(byLikes);\n      setBlogs(updatedBlogs);\n    });\n  };\n\n  const likeBlog = async id => {\n    const toLike = blogs.find(b => b.id === id);\n    const liked = { ...toLike,\n      likes: (toLike.likes || 0) + 1,\n      user: toLike.user.id\n    };\n    blogService.update(liked.id, liked).then(updatedBlog => {\n      notify(`you liked '${updatedBlog.title}' by ${updatedBlog.author}`);\n      const updatedBlogs = blogs.map(b => b.id === id ? updatedBlog : b).sort(byLikes);\n      setBlogs(updatedBlogs);\n    });\n  };\n\n  const notify = function (message) {\n    let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n    setNotification({\n      message,\n      type\n    });\n    setTimeout(() => {\n      setNotification(null);\n    }, 5000);\n  };\n\n  if (user === null) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Notification, {\n        notification: notification\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 132,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(LoginForm, {\n        onLogin: login\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 133,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"blogs\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 140,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Notification, {\n      notification: notification\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      children: [user.name, \" logged in\", /*#__PURE__*/_jsxDEV(\"button\", {\n        onClick: logout,\n        children: \"logout\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 146,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 144,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Togglable, {\n      buttonLabel: \"new note\",\n      ref: blogFormRef,\n      children: /*#__PURE__*/_jsxDEV(NewBlogForm, {\n        onCreate: createBlog\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 150,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 149,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"blogs\",\n      children: blogs.map(blog => /*#__PURE__*/_jsxDEV(Blog, {\n        blog: blog,\n        likeBlog: likeBlog,\n        removeBlog: removeBlog,\n        user: user\n      }, blog.id, false, {\n        fileName: _jsxFileName,\n        lineNumber: 155,\n        columnNumber: 21\n      }, this))\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 139,\n    columnNumber: 9\n  }, this);\n};\n\n_s(App, \"Yyc/+lu8apLmOwefImHrwsBKCc8=\");\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/ytuukka/Full_Stack_2021/osa_7/blogapp/frontend/src/App.js"],"names":["useState","useEffect","useRef","createStore","Blog","LoginForm","NewBlogForm","Notification","Togglable","blogService","loginService","userService","initialState","message","type","notificationReducer","state","action","data","store","App","blogs","setBlogs","user","setUser","notification","setNotification","blogFormRef","byLikes","b1","b2","likes","getAll","then","sort","userFromStorage","getUser","login","username","password","notify","name","catch","logout","clearUser","createBlog","blog","create","createdBlog","title","author","concat","current","toggleVisibility","error","response","removeBlog","id","toRemove","find","b","ok","window","confirm","remove","updatedBlogs","filter","likeBlog","toLike","liked","update","updatedBlog","map","setTimeout"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef } from 'react'\nimport { createStore } from 'redux'\n\nimport Blog from './components/Blog'\nimport LoginForm from './components/LoginForm'\nimport NewBlogForm from './components/NewBlogForm'\nimport Notification from './components/Notification'\nimport Togglable from './components/Togglable'\n\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport userService from './services/user'\n\nconst initialState = {\n    message: null,\n    type: 'info',\n}\n\nconst notificationReducer = (state = initialState, action) => {\n    switch (action.type) {\n        case 'SET':\n            return (state = action.data)\n        default:\n            return state\n    }\n}\n\nconst store = createStore(notificationReducer)\n\nconst App = () => {\n    const [blogs, setBlogs] = useState([])\n    const [user, setUser] = useState(null)\n    const [notification, setNotification] = useState(null)\n    const blogFormRef = useRef()\n    const byLikes = (b1, b2) => (b2.likes > b1.likes ? 1 : -1)\n\n    useEffect(() => {\n        blogService.getAll().then((blogs) => setBlogs(blogs.sort(byLikes)))\n    }, [])\n\n    useEffect(() => {\n        const userFromStorage = userService.getUser()\n        if (userFromStorage) {\n            setUser(userFromStorage)\n        }\n    }, [])\n\n    const login = async (username, password) => {\n        loginService\n            .login({\n                username,\n                password,\n            })\n            .then((user) => {\n                setUser(user)\n                userService.setUser(user)\n                notify(`${user.name} logged in!`)\n            })\n            .catch(() => {\n                notify('wrong username/password', 'alert')\n            })\n    }\n\n    const logout = () => {\n        setUser(null)\n        userService.clearUser()\n        notify('good bye!')\n    }\n\n    const createBlog = async (blog) => {\n        blogService\n            .create(blog)\n            .then((createdBlog) => {\n                notify(\n                    `a new blog '${createdBlog.title}' by ${createdBlog.author} added`\n                )\n                setBlogs(blogs.concat(createdBlog))\n                blogFormRef.current.toggleVisibility()\n            })\n            .catch((error) => {\n                notify(\n                    'creating a blog failed: ' + error.response.data.error,\n                    'alert'\n                )\n            })\n    }\n\n    const removeBlog = (id) => {\n        const toRemove = blogs.find((b) => b.id === id)\n\n        const ok = window.confirm(\n            `remove '${toRemove.title}' by ${toRemove.author}?`\n        )\n\n        if (!ok) {\n            return\n        }\n\n        blogService.remove(id).then(() => {\n            const updatedBlogs = blogs.filter((b) => b.id !== id).sort(byLikes)\n            setBlogs(updatedBlogs)\n        })\n    }\n\n    const likeBlog = async (id) => {\n        const toLike = blogs.find((b) => b.id === id)\n        const liked = {\n            ...toLike,\n            likes: (toLike.likes || 0) + 1,\n            user: toLike.user.id,\n        }\n\n        blogService.update(liked.id, liked).then((updatedBlog) => {\n            notify(`you liked '${updatedBlog.title}' by ${updatedBlog.author}`)\n            const updatedBlogs = blogs\n                .map((b) => (b.id === id ? updatedBlog : b))\n                .sort(byLikes)\n            setBlogs(updatedBlogs)\n        })\n    }\n\n    const notify = (message, type = 'info') => {\n        setNotification({ message, type })\n        setTimeout(() => {\n            setNotification(null)\n        }, 5000)\n    }\n\n    if (user === null) {\n        return (\n            <>\n                <Notification notification={notification} />\n                <LoginForm onLogin={login} />\n            </>\n        )\n    }\n\n    return (\n        <div>\n            <h2>blogs</h2>\n\n            <Notification notification={notification} />\n\n            <div>\n                {user.name} logged in\n                <button onClick={logout}>logout</button>\n            </div>\n\n            <Togglable buttonLabel=\"new note\" ref={blogFormRef}>\n                <NewBlogForm onCreate={createBlog} />\n            </Togglable>\n\n            <div id=\"blogs\">\n                {blogs.map((blog) => (\n                    <Blog\n                        key={blog.id}\n                        blog={blog}\n                        likeBlog={likeBlog}\n                        removeBlog={removeBlog}\n                        user={user}\n                    />\n                ))}\n            </div>\n        </div>\n    )\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}