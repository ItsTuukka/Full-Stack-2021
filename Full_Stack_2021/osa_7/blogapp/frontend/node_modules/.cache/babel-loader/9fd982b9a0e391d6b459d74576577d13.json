{"ast":null,"code":"var _jsxFileName = \"/home/ytuukka/Full_Stack_2021/osa_7/blogapp/frontend/src/App.js\",\n    _s = $RefreshSig$();\n\nimport { useState, useEffect, useRef } from 'react';\nimport Bloglist from './components/Bloglist';\nimport LoginForm from './components/LoginForm';\nimport Notification from './components/Notification';\nimport Userlist from './components/Userlist';\nimport User from './components/User';\nimport BlogDetails from './components/BlogDetails';\nimport NavigationMenu from './components/NavigationMenu';\nimport blogService from './services/blogs';\nimport loginService from './services/login';\nimport userService from './services/user';\nimport { setNotification } from './reducers/notificationReducer';\nimport { useDispatch } from 'react-redux';\nimport { useMatch, Routes, Route, Navigate } from 'react-router-dom';\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst App = () => {\n  _s();\n\n  const [blogs, setBlogs] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [user, setUser] = useState(null);\n  const blogFormRef = useRef();\n\n  const byLikes = (b1, b2) => b2.likes > b1.likes ? 1 : -1;\n\n  const dispatch = useDispatch();\n  useEffect(() => {\n    blogService.getAll().then(blogs => setBlogs(blogs.sort(byLikes)));\n  }, []);\n  useEffect(() => {\n    userService.getAll().then(users => setUsers(users));\n  }, []);\n  useEffect(() => {\n    const userFromStorage = userService.getUser();\n\n    if (userFromStorage) {\n      setUser(userFromStorage);\n    }\n  }, []);\n\n  const login = async (username, password) => {\n    loginService.login({\n      username,\n      password\n    }).then(user => {\n      setUser(user);\n      userService.setUser(user);\n      notify(`${user.name} logged in!`);\n    }).catch(() => {\n      notify('wrong username/password', 'alert');\n    });\n  };\n\n  const logout = () => {\n    setUser(null);\n    userService.clearUser();\n    notify('good bye!');\n  };\n\n  const createBlog = async blog => {\n    blogService.create(blog).then(createdBlog => {\n      notify(`a new blog '${createdBlog.title}' by ${createdBlog.author} added`);\n      setBlogs(blogs.concat(createdBlog));\n      blogFormRef.current.toggleVisibility();\n    }).catch(error => {\n      notify('creating a blog failed', 'alert');\n    });\n  };\n\n  const removeBlog = id => {\n    const toRemove = blogs.find(b => b.id === id);\n    const ok = window.confirm(`remove '${toRemove.title}' by ${toRemove.author}?`);\n\n    if (!ok) {\n      return;\n    }\n\n    blogService.remove(id).then(() => {\n      const updatedBlogs = blogs.filter(b => b.id !== id).sort(byLikes);\n      setBlogs(updatedBlogs);\n    });\n  };\n\n  const likeBlog = async id => {\n    const toLike = blogs.find(b => b.id === id);\n    const liked = { ...toLike,\n      likes: (toLike.likes || 0) + 1,\n      user: toLike.user.id\n    };\n    blogService.update(liked.id, liked).then(updatedBlog => {\n      notify(`you liked '${updatedBlog.title}' by ${updatedBlog.author}`);\n      const updatedBlogs = blogs.map(b => b.id === id ? updatedBlog : b).sort(byLikes);\n      setBlogs(updatedBlogs);\n    });\n  };\n\n  const addComment = async _ref => {\n    let {\n      id,\n      comment\n    } = _ref;\n    const toComment = blogs.find(b => b.id === id);\n    const commented = { ...toComment,\n      comments: toComment.comments.concat(comment)\n    };\n  };\n\n  const notify = function (message) {\n    let type = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : 'info';\n    dispatch(setNotification(message, type));\n  };\n\n  const usermatch = useMatch('/users/:id');\n  const userById = usermatch ? users.find(user => user.id === usermatch.params.id) : null;\n  const blogmatch = useMatch('/blogs/:id');\n  const blogById = blogmatch ? blogs.find(blog => blog.id === blogmatch.params.id) : null;\n\n  if (user === null) {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(Notification, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 140,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(LoginForm, {\n        onLogin: login\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 141,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true);\n  }\n\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      children: /*#__PURE__*/_jsxDEV(NavigationMenu, {\n        user: user,\n        logout: logout\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 149,\n        columnNumber: 17\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 148,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n      children: \"blog app\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Notification, {}, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 152,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(Routes, {\n      children: [/*#__PURE__*/_jsxDEV(Route, {\n        path: \"/blogs/:id\",\n        element: blogById ? /*#__PURE__*/_jsxDEV(BlogDetails, {\n          blog: blogById,\n          likeBlog: likeBlog,\n          removeBlog: removeBlog,\n          addComment: addComment,\n          user: user\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 158,\n          columnNumber: 29\n        }, this) : /*#__PURE__*/_jsxDEV(Navigate, {\n          replace: true,\n          to: \"/\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 166,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 154,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/users/:id\",\n        element: /*#__PURE__*/_jsxDEV(User, {\n          user: userById\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 170,\n          columnNumber: 51\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 170,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/users\",\n        element: /*#__PURE__*/_jsxDEV(Userlist, {\n          users: users\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 171,\n          columnNumber: 47\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 171,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(Route, {\n        path: \"/\",\n        element: /*#__PURE__*/_jsxDEV(Bloglist, {\n          blogs: blogs,\n          likeBlog: likeBlog,\n          removeBlog: removeBlog,\n          user: user,\n          createBlog: createBlog\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 175,\n          columnNumber: 25\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 147,\n    columnNumber: 9\n  }, this);\n};\n\n_s(App, \"aN2OnfQMjQcY0hMKoQBYxDN7TYo=\", false, function () {\n  return [useDispatch, useMatch, useMatch];\n});\n\n_c = App;\nexport default App;\n\nvar _c;\n\n$RefreshReg$(_c, \"App\");","map":{"version":3,"sources":["/home/ytuukka/Full_Stack_2021/osa_7/blogapp/frontend/src/App.js"],"names":["useState","useEffect","useRef","Bloglist","LoginForm","Notification","Userlist","User","BlogDetails","NavigationMenu","blogService","loginService","userService","setNotification","useDispatch","useMatch","Routes","Route","Navigate","App","blogs","setBlogs","users","setUsers","user","setUser","blogFormRef","byLikes","b1","b2","likes","dispatch","getAll","then","sort","userFromStorage","getUser","login","username","password","notify","name","catch","logout","clearUser","createBlog","blog","create","createdBlog","title","author","concat","current","toggleVisibility","error","removeBlog","id","toRemove","find","b","ok","window","confirm","remove","updatedBlogs","filter","likeBlog","toLike","liked","update","updatedBlog","map","addComment","comment","toComment","commented","comments","message","type","usermatch","userById","params","blogmatch","blogById"],"mappings":"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","sourcesContent":["import { useState, useEffect, useRef } from 'react'\n\nimport Bloglist from './components/Bloglist'\nimport LoginForm from './components/LoginForm'\nimport Notification from './components/Notification'\nimport Userlist from './components/Userlist'\nimport User from './components/User'\nimport BlogDetails from './components/BlogDetails'\nimport NavigationMenu from './components/NavigationMenu'\n\nimport blogService from './services/blogs'\nimport loginService from './services/login'\nimport userService from './services/user'\n\nimport { setNotification } from './reducers/notificationReducer'\nimport { useDispatch } from 'react-redux'\n\nimport { useMatch, Routes, Route, Navigate } from 'react-router-dom'\n\nconst App = () => {\n    const [blogs, setBlogs] = useState([])\n    const [users, setUsers] = useState([])\n    const [user, setUser] = useState(null)\n    const blogFormRef = useRef()\n    const byLikes = (b1, b2) => (b2.likes > b1.likes ? 1 : -1)\n\n    const dispatch = useDispatch()\n\n    useEffect(() => {\n        blogService.getAll().then((blogs) => setBlogs(blogs.sort(byLikes)))\n    }, [])\n\n    useEffect(() => {\n        userService.getAll().then((users) => setUsers(users))\n    }, [])\n\n    useEffect(() => {\n        const userFromStorage = userService.getUser()\n        if (userFromStorage) {\n            setUser(userFromStorage)\n        }\n    }, [])\n\n    const login = async (username, password) => {\n        loginService\n            .login({\n                username,\n                password,\n            })\n            .then((user) => {\n                setUser(user)\n                userService.setUser(user)\n                notify(`${user.name} logged in!`)\n            })\n            .catch(() => {\n                notify('wrong username/password', 'alert')\n            })\n    }\n\n    const logout = () => {\n        setUser(null)\n        userService.clearUser()\n        notify('good bye!')\n    }\n\n    const createBlog = async (blog) => {\n        blogService\n            .create(blog)\n            .then((createdBlog) => {\n                notify(\n                    `a new blog '${createdBlog.title}' by ${createdBlog.author} added`\n                )\n                setBlogs(blogs.concat(createdBlog))\n                blogFormRef.current.toggleVisibility()\n            })\n            .catch((error) => {\n                notify('creating a blog failed', 'alert')\n            })\n    }\n\n    const removeBlog = (id) => {\n        const toRemove = blogs.find((b) => b.id === id)\n\n        const ok = window.confirm(\n            `remove '${toRemove.title}' by ${toRemove.author}?`\n        )\n\n        if (!ok) {\n            return\n        }\n\n        blogService.remove(id).then(() => {\n            const updatedBlogs = blogs.filter((b) => b.id !== id).sort(byLikes)\n            setBlogs(updatedBlogs)\n        })\n    }\n\n    const likeBlog = async (id) => {\n        const toLike = blogs.find((b) => b.id === id)\n        const liked = {\n            ...toLike,\n            likes: (toLike.likes || 0) + 1,\n            user: toLike.user.id,\n        }\n\n        blogService.update(liked.id, liked).then((updatedBlog) => {\n            notify(`you liked '${updatedBlog.title}' by ${updatedBlog.author}`)\n            const updatedBlogs = blogs\n                .map((b) => (b.id === id ? updatedBlog : b))\n                .sort(byLikes)\n            setBlogs(updatedBlogs)\n        })\n    }\n\n    const addComment = async ({ id, comment }) => {\n        const toComment = blogs.find((b) => b.id === id)\n        const commented = {\n            ...toComment,\n            comments: toComment.comments.concat(comment),\n        }\n    }\n\n    const notify = (message, type = 'info') => {\n        dispatch(setNotification(message, type))\n    }\n\n    const usermatch = useMatch('/users/:id')\n    const userById = usermatch\n        ? users.find((user) => user.id === usermatch.params.id)\n        : null\n\n    const blogmatch = useMatch('/blogs/:id')\n    const blogById = blogmatch\n        ? blogs.find((blog) => blog.id === blogmatch.params.id)\n        : null\n\n    if (user === null) {\n        return (\n            <>\n                <Notification />\n                <LoginForm onLogin={login} />\n            </>\n        )\n    }\n\n    return (\n        <div>\n            <div>\n                <NavigationMenu user={user} logout={logout} />\n            </div>\n            <h2>blog app</h2>\n            <Notification />\n            <Routes>\n                <Route\n                    path=\"/blogs/:id\"\n                    element={\n                        blogById ? (\n                            <BlogDetails\n                                blog={blogById}\n                                likeBlog={likeBlog}\n                                removeBlog={removeBlog}\n                                addComment={addComment}\n                                user={user}\n                            />\n                        ) : (\n                            <Navigate replace to=\"/\" />\n                        )\n                    }\n                />\n                <Route path=\"/users/:id\" element={<User user={userById} />} />\n                <Route path=\"/users\" element={<Userlist users={users} />} />\n                <Route\n                    path=\"/\"\n                    element={\n                        <Bloglist\n                            blogs={blogs}\n                            likeBlog={likeBlog}\n                            removeBlog={removeBlog}\n                            user={user}\n                            createBlog={createBlog}\n                        />\n                    }\n                />\n            </Routes>\n        </div>\n    )\n}\n\nexport default App\n"]},"metadata":{},"sourceType":"module"}